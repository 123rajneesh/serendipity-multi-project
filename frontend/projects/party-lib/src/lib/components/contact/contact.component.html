<command-bar>

  <ng-container>

    <button mat-flat-button class="md-command-bar-button"
            [disabled]="!isDirty() || !isValid()"
            (click)="onSave()">
      <mat-icon svgIcon="save"> </mat-icon>
      <span i18n="Command Bar Item|Contact@@SAVE">
        SAVE
      </span>
    </button>

    <button mat-flat-button class="md-command-bar-button"
            [disabled]="!isDirty() || !isValid()"
            (click)="onSaveAndClose()">
      <mat-icon svgIcon="arrow-back"> </mat-icon>
      <span i18n="Command Bar Item|Contact@NSAVE_AND_CLOSE">
        SAVE & CLOSE
      </span>
    </button>

  </ng-container>

  <button mat-flat-button class="md-command-bar-button"
          (click)="onNew()">
    <mat-icon svgIcon="add"> </mat-icon>
    <span i18n="Command Bar Item|Contact@@NEW">
      NEW
    </span>
  </button>

  <button mat-flat-button class="md-command-bar-button"
          (click)="onDeactivate()"
          [disabled]="true">
    <mat-icon svgIcon="visibility-off"> </mat-icon>
    <span i18n="Command Bar Item|Contact@@DEACTIVATE">
      DEACTIVATE
    </span>
  </button>

  <button mat-flat-button class="md-command-bar-button"
          [disabled]="true">
    <mat-icon svgIcon="link"> </mat-icon>
    <span i18n="Command Bar Item|Contact@@EMAIL_A_LINK">
      EMAIL A LINK
    </span>
  </button>

  <div fxFlex fxLayout fxLayoutAlign="flex-end">

    <!--
    <button mat-button class="crm-command-bar-button" [disabled]="true">
      <mat-icon>open_in_new</mat-icon>
    </button>
    -->

    <button mat-button class="md-command-bar-button"
            (click)="onClose()">
      <mat-icon svgIcon="clear"> </mat-icon>
    </button>

  </div>

</command-bar>

<activity-bar>

  <ng-container *ngIf="item">

    <span class="md-activity-bar-title" i18n="Activity Bar Title|Contact@@CONTACT_TITLE">
      Contact: {{ item.party.displayName }}
    </span>

  </ng-container>

</activity-bar>

<div class="md-content-container">

  <ng-container *ngIf="!item; then skeleton"> </ng-container>

  <ng-container *ngIf="item">

    <mat-tab-group [color]="'primary'"
                   (selectedTabChange)="onTabChanged($event)">

      <mat-tab label="Summary">

        <div #gridContainer class="md-grid-container">

          <mat-card>

            <!--
            <mat-card-header>
              <mat-card-title>
                General Information
              </mat-card-title>
            </mat-card-header>
            -->

            <mat-card-content>

              <!-- Chrome ignores autocomplete="off" so go to chrome://settings/autofill and turn 'Auto-fill forms' off -->

              <dynamic-form autocomplete="off"
                            className="md-nested-grid-container"
                            [formGroup]="generalInformationGroup"
                            [model]="generalInformationModel"
                            (customEvent)="onCustomEvent($event)">
              </dynamic-form>

              <!--
              <p>
                Form Value: {{ generalInformationGroup.value | json }}
              </p>
              -->

            </mat-card-content>

          </mat-card>

          <mat-card>

            <!--
            <mat-card-header>
              <mat-card-title>
                Address Information
              </mat-card-title>
            </mat-card-header>
            -->

            <mat-card-content>

              <!-- Chrome ignores autocomplete="off" so go to chrome://settings/autofill and turn 'Auto-fill forms' off -->

              <dynamic-form autocomplete="off"
                            className="md-nested-grid-container"
                            [formGroup]="addressInformationGroup"
                            [model]="addressInformationModel">
              </dynamic-form>

              <!--
              <p>
                Form Value: {{ addressInformationGroup.value | json }}
              </p>
              -->

            </mat-card-content>

          </mat-card>

        </div>

      </mat-tab>

      <mat-tab label="Details">

        <ng-template matTabContent>

          <!-- See: https://material.angular.io/components/tabs/overview#lazy-loading -->

          Details tab: I was lazy loaded...

        </ng-template>

      </mat-tab>

      <mat-tab label="Relationships">

        <ng-template matTabContent>

          <contact-relationship-list [item]="item">

          </contact-relationship-list>

        </ng-template>

      </mat-tab>

      <mat-tab *ngIf="item.electorate" label="Electoral Division">

        <div class="map-container"
             leaflet
             [leafletOptions]="mapOptions"
             (leafletMapReady)="onMapReady($event)">
        </div>

      </mat-tab>

    </mat-tab-group>

  </ng-container>

  <!-- Skeleton template -->

  <ng-template #skeleton>

    <div class="md-spinner-container">
      <mat-spinner color="accent"></mat-spinner>
    </div>

  </ng-template>

</div>
